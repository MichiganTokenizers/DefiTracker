# DefiTracker Web UI systemd Service
# ==================================
#
# This service file runs the Flask web UI automatically on boot.
#
# Installation:
#   sudo cp /home/danladuke/DefiTracker/systemd/defitracker.service /etc/systemd/system/
#   sudo systemctl daemon-reload
#   sudo systemctl enable defitracker
#   sudo systemctl start defitracker
#
# Management:
#   sudo systemctl status defitracker   # Check status
#   sudo systemctl restart defitracker  # Restart service
#   sudo systemctl stop defitracker     # Stop service
#   sudo journalctl -u defitracker -f   # View logs
#
# Note: Adjust the User, Group, and WorkingDirectory if you installed
# to a different location or use a different username.

[Unit]
Description=DefiTracker Web UI - DeFi APR/APY Dashboard
Documentation=https://github.com/yourusername/DefiTracker
After=network.target postgresql.service
Wants=postgresql.service

[Service]
Type=simple
User=danladuke
Group=danladuke
WorkingDirectory=/home/danladuke/DefiTracker

# Python virtual environment
Environment="PATH=/home/danladuke/DefiTracker/venv/bin:/usr/local/bin:/usr/bin:/bin"
Environment="FLASK_APP=src.api.app:app"
Environment="FLASK_ENV=production"

# Run Flask on all interfaces, port 5000
ExecStart=/home/danladuke/DefiTracker/venv/bin/python -m flask run --host=0.0.0.0 --port=5000

# Restart policy
Restart=always
RestartSec=10

# Security hardening
NoNewPrivileges=true
# These require kernel namespace support (not available on Raspberry Pi):
# ProtectSystem=strict
# ProtectHome=read-only
# ReadWritePaths=/home/danladuke/DefiTracker/logs

# Resource limits (adjust based on your needs)
MemoryMax=512M
CPUQuota=80%

[Install]
WantedBy=multi-user.target

